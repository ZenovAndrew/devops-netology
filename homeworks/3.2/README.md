### Домашнее задание к занятию "3.2. Работа в терминале, лекция 2"

#### 1. Какого типа команда cd?

```
$ type cd
cd is a shell builtin

Это встроенная команда. Встроенная потому, что работает внутри сессии терминала. Логичнее менять указатель на текущую директорию внутренней функцией внутри своего окружения. Если программа была бы внешней то после смене директории приходилось бы вызывать новый экземляр bash, и после выхода из каталога выходить из всех сессий.  
```

#### 2. Какая альтернатива без pipe команде grep <some_string> <some_file> | wc -l?

```
grep –c <some_string> <some_file>

```

#### 3. Какой процесс с PID 1 является родителем для всех процессов в вашей виртуальной машине Ubuntu 20.04?  

```shell
$ pstree -a -p  | head -n 1
systemd,1
```

#### 4. Как будет выглядеть команда, которая перенаправит вывод stderr ls на другую сессию терминала?  

```shell
sudo su
ls 2 > /dev/tty1


```

#### 5. Получится ли одновременно передать команде файл на stdin и вывести ее stdout в другой файл? Приведите работающий пример.  

```shell
cat < test.in > test.out

```

#### 6. Получится ли вывести находясь в графическом режиме данные из PTY в какой-либо из эмуляторов TTY? Сможете ли вы наблюдать выводимые данные?  

```shell
sudo su
echo hello > /dev/tty1
```
#### 7. Выполните команду bash 5>&1. К чему она приведет? Что будет, если вы выполните echo netology > /proc/$$/fd/5? Почему так происходит?  

```
Создаст и направит файловый дескриптор 5 в то же место что и 1 (стандартный вывод)
Выведет дескриптор 5 который был направлен на стандартный вывод

```


#### 8. Получится ли в качестве входного потока для pipe использовать только stderr команды, не потеряв при этом отображение stdout на pty?  

```shell
cat test 5>&2 2>&1 1>&5

```

#### 9. Что выведет команда cat /proc/$$/environ? Как еще можно получить аналогичный по содержанию вывод?  


````
Отображаются переменные среды процесса. 
```shell
ps e –p $$
```

Похожее вернут команды `env` и `printenv`.
```

#### 10. Используя man, опишите что доступно по адресам /proc/<PID>/cmdline, /proc/<PID>/exe.  

```
/proc/<PID>/cmdline – файл для чтения, содержит путь к запущенной команде с ключом запуска для соответствующего идентификатора процесса. Если процесс является зомби-процессом, то этот файл будет пустой
/proc/<PID>/exe  - содержит символическую ссылку на исполняемый файл запущенной команды 

```
#### 11. Узнайте, какую наиболее старшую версию набора инструкций SSE поддерживает ваш процессор с помощью /proc/cpuinfo.  

```shell
$ cat /proc/cpuinfo  | grep -o 'sse[0-9_]*' | sort -h | uniq
sse
sse2
sse3
sse4_1
sse4_2
```
SSE 4.2  

#### 12. При открытии нового окна терминала и vagrant ssh создается новая сессия и выделяется pty. Однако ... not a tty ... Почитайте, почему так происходит, и как изменить поведение.  

```shell
$ ssh localhost 'tty'
vagrant@localhost's password:
not a tty
```

Это сделано для правильной работы в скриптах. Если сразу выполнить команду на удалённом сервере через ssh, sshd это поймёт, и запускаемые команды тоже, поэтому они не будут спрашивать что-то у пользователя, а вывод очистят от лишних данных.

Например, если в интерактивном режиме программа задала бы пользователю вопрос и ждала ответа "yes/no", при запуске через ssh она этого делать не станет.

Для подключения к псевдотерминальному окну надо использовать ключ -t
ssh –t localhost 'tty'



```shell
$ ssh -t localhost 'tty'
vagrant@localhost's password:
/dev/pts/1
Connection to localhost closed.
```


#### 13. Бывает, что есть необходимость переместить запущенный процесс из одной сессии в другую. Попробуйте сделать это, воспользовавшись reptyr.  

```
Получилось из под root перехватить команду top запущенную другим пользователем
1.Устанавливаем reptyr
2. Прописываем ptrace_scope = 0
3. Запускаем с ключем –T

```
#### 14. Узнайте что делает команда tee и почему в отличие от sudo echo команда с sudo tee будет работать.  

Команда `tee` читает стандартный ввод и записывает в стандартный вывод. Потому что с `sudo tee` команде предоставляются суперпользовательские права доступа.
